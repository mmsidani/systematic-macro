earningsVsGDPRate.wbData<-list(
years=c("1961	1962	1963	1964	1965	1966	1967	1968	1969	1970	1971	1972	1973	1974	1975	1976	1977	1978	1979	1980	1981	1982	1983	1984	1985	1986	1987	1988	1989	1990	1991	1992	1993	1994	1995	1996	1997	1998	1999	2000	2001	2002	2003	2004	2005	2006	2007	2008	2009	2010"),
ca=c("3.163291684	7.116779267	5.181776082	6.699456682	6.636545139	6.584965408	2.91531036	5.295341864	5.260000826	2.583421925	4.117657622	5.44585558	6.964202918	3.690987646	1.822973134	5.199302437	3.4582306	3.953591265	3.804922881	2.162616899	3.503119534	-2.859005473	2.717806163	5.814468359	4.780075557	2.420782761	4.253218954	4.974472448	2.619402966	0.193024882	-2.092163263	0.875192284	2.338542772	4.804210097	2.808429062	1.618799885	4.225916502	4.097432461	5.531762882	5.233288646	1.78380122	2.924529481	1.88107433	3.119976979	3.019057345	2.823032729	2.200021356	0.688726873	-2.76976818	3.214948408"),
fr=c("5.506272437	6.672174626	5.347173767	6.518338303	4.778035177	5.214008052	4.688158821	4.25902469	6.990530534	5.730968476	5.330428843	4.537591359	6.61025197	4.690973791	-1.123773644	4.386077365	3.572694241	3.895249666	3.449256086	1.636673139	0.979005474	2.417286865	1.231903342	1.49456169	1.610130828	2.255898859	2.388362301	4.667599528	4.187713282	2.620068343	1.039330738	1.477874361	-0.667373535	2.247397202	2.047247141	1.06756419	2.183787041	3.378211869	3.291959096	3.680000363	1.835706973	0.928913858	0.899504293	2.54472819	1.826524011	2.466911701	2.285198816	-0.080667076	-2.729785134	1.479960365"),
ge=c("NA	NA	NA	NA	NA	NA	NA	NA	NA	NA	3.132699754	4.300341297	4.777486911	0.890068707	-0.866738895	4.949258392	3.34721809	3.008492875	4.150363331	1.40882866	0.52924054	-0.394840748	1.572410148	2.822947834	2.327935223	2.287339268	1.402151577	3.707235666	3.896551724	5.255006085	5.108261509	1.911886949	-1.002097413	2.471751412	1.677004365	0.790781744	1.737278637	1.861848628	1.871079386	3.057649432	1.514371072	0.010148163	-0.375443937	1.161132614	0.684655658	3.7	3.269045323	1.083201046	-5.127020785	3.690360273"),
us=c("2.3	6.1	4.4	5.8	6.4	6.5	2.5	4.8	3.1	0.2	3.458014905	5.521782019	5.911126571	-0.519325903	-0.196021789	5.41875995	4.638164346	5.626464249	3.147789982	-0.287282173	2.541232489	-1.980247994	4.515962925	7.194823537	4.112023532	3.427217611	3.167105357	4.100067576	3.564993906	1.856092101	-0.261221209	3.4047697	2.872555466	4.114534629	2.548972794	3.786073016	4.505736321	4.490350805	4.869650281	4.17339067	1.093331662	1.82731315	2.502587834	3.585430846	3.059076051	2.674149622	1.941762606	-0.020505966	-3.5	3"),
uk=c("2.573569963	1.327993179	3.956241167	5.038282449	2.788976828	2.049311178	2.310965101	3.984737995	2.052445651	2.455016319	2.024230913	3.566472228	7.127890593	-1.359979255	-0.626648453	2.64412852	2.394420767	3.241292174	2.687771096	-2.087170805	-1.216495849	2.202563586	3.691069762	2.691526847	3.623744147	4.014298954	4.562129274	5.032010041	2.281417297	0.779280234	-1.392465127	0.146640607	2.222234873	4.280238857	3.052326202	2.885321006	6.207328708	3.83900318	3.655691402	4.457651779	3.150665862	2.657506236	3.524621119	2.955330269	2.085765842	2.607116575	3.466163321	-1.102864344	-4.373336235	2.092165556"),
no=c("6.27333551	2.813945138	3.785043084	5.009650987	5.285608801	3.786513255	6.256079006	2.259875528	4.504611456	1.998635388	5.617751937	5.268044687	4.478776925	3.818535295	5.025378685	5.792628207	4.139159983	3.853947174	4.357737764	4.504155581	1.54754393	0.124997803	3.866893289	5.894078185	5.354026293	4.037551573	1.780044351	-0.172854737	0.997532513	1.92678163	3.105448661	3.523167173	2.786581506	5.051479907	4.18630362	5.099765266	5.392629526	2.682749785	2.025778824	3.253547126	1.990095341	1.502079339	0.983433324	3.961030511	2.58893558	2.45192855	2.652996754	0.035093987	-1.667131673	0.676520209"),
sg=c("13.82038516	-0.040650289	8.906061829	0.560117862	13.86786688	10.85196055	12.25889285	13.55161316	13.65205035	13.81482677	12.03174986	13.48792854	11.08874509	6.305289879	4.438226639	7.400649761	7.462707964	8.676409771	9.397546731	10.04704424	10.72553838	7.185694914	8.567899909	8.824943369	-0.650096715	1.28729213	10.77211574	11.07349166	10.22838063	10.10687116	6.485432336	7.031250888	11.47939471	10.57488141	7.278340129	7.740215666	8.55416328	-2.107524373	6.213311254	9.073645148	-1.219949832	4.239146816	4.598699603	9.23630422	7.382768859	8.703237201	8.774664229	1.487003004	-0.770050308	14.47127163"),
sw=c("5.681537344	4.258772994	5.327897811	6.821456714	3.821453148	2.090836479	3.365497939	3.638252334	5.009649556	6.042008752	0.94464624	2.288738799	3.967981128	3.19819563	2.552862674	1.058104865	-1.596258584	1.751548043	3.840003514	1.699971418	-0.202272892	1.193113834	1.809751468	4.271307354	2.189675481	2.861091843	3.45710699	2.666403628	2.779148019	1.010299171	-1.121288508	-1.203494529	-2.057787481	4.012622456	3.938535729	1.612216884	2.708417966	4.20495269	4.659837834	4.452192565	1.262310434	2.483417078	2.335701803	4.23486171	3.160784989	4.297178966	3.314245356	-0.613416136	-5.172123705	5.609925729"),
jp=c("12.04353641	8.908972996	8.473642383	11.6767082	5.819707873	10.63856156	11.08214232	12.88246814	12.47789451	4.2867504	4.698992042	8.413547255	8.032599975	-1.225239828	3.091575916	3.974984091	4.39033795	5.271941503	5.484041832	2.817591208	2.933447361	2.764345031	1.611811031	3.118918517	5.082425142	2.95868907	3.794990665	6.764768063	5.290937138	5.201470686	3.324340775	0.819029859	0.17106272	0.863578244	1.881656088	2.637287364	1.563566593	-2.04886791	-0.141010782	2.860139431	0.184389483	0.262257029	1.413540274	2.744262097	1.934092538	2.039469247	2.362841018	-1.165288625	-6.287582275	4"),
hk=c("14.92741158	14.59354458	11.67164124	11.6014435	16.5964483	6.853866884	1.95551777	3.238130398	11.97000877	9.50963056	7.407583613	11.00282801	17.39835208	2.167064398	0.531850091	16.46281075	11.64266825	8.465452021	11.63955945	10.30525335	9.317221532	2.920421379	5.965961342	9.922661166	0.671627678	11.09783788	13.4110366	8.444681834	2.222136203	3.898479703	5.694532942	6.093074468	6.04316966	6.013314774	2.293275697	4.192907669	5.056272262	-6.026386643	2.555949592	7.951509373	0.497301683	1.840985015	3.0060137	8.466611359	7.082103152	7.019775443	6.389334239	2.30631542	-2.660524257	6.970071293"),
nl=c("0.295546673	6.843507321	3.62462153	8.274903931	8.643094936	2.741104335	5.280014747	6.41613404	6.429449078	5.694795536	4.330778433	2.506529078	5.784268034	4.255923243	0.123019711	4.787653117	1.921278167	2.330748492	2.02191842	3.251004169	-0.783611603	-1.240756768	2.069958061	3.061679034	2.580179809	2.786975855	1.93124852	3.441218901	4.420253133	4.183127225	2.439038246	1.706076772	1.257616445	2.961084277	3.115978411	3.406520394	4.278444692	3.92346388	4.684381322	3.941036849	1.925856601	0.076313293	0.335603995	2.236514565	2.046466883	3.394188237	3.920630405	1.80405877	-3.536699804	1.689571469"),
au=c("2.507532139	1.366729469	6.259566689	6.977787473	5.999038184	2.370806989	6.271228506	5.142824734	7.047053336	7.15848258	4.019230344	3.931209812	2.623936544	4.065772414	1.244887838	2.633328837	3.483656167	0.908381979	4.113518085	3.04394022	3.407837326	3.22786095	-2.320034859	4.598488422	5.130585749	4.551541173	2.553458148	5.872219748	3.939817999	3.57475914	-0.239267129	0.454063604	4.085981791	3.966137304	3.939983314	4.181423944	3.972448021	4.585530281	5.15985438	3.951352155	2.071616393	3.903791221	3.272264035	4.155794748	2.959140943	3.081394099	3.564177973	3.832065489	1.448372288	2.256937114"),
eu=c("6.61834025	6.352177197	5.70861303	5.501647793	4.924923782	5.241252179	5.23860725	5.486213555	6.938998244	5.661338447	3.787344488	4.816611428	6.192396707	3.29154584	-0.800648281	5.037947172	3.081821794	3.101255476	3.863296893	2.256710704	0.513855712	0.701420952	1.389745906	2.366733318	2.29606919	2.480185251	2.45626381	4.249665003	4.037024165	3.517024449	2.549246434	1.299676158	-0.7137578	2.454029321	2.422782461	1.535071838	2.607886968	2.793163651	2.894831312	3.774883876	1.97391018	0.9141182	0.709542685	2.195650631	1.677648388	3.244559284	2.993240363	0.382073653	-4.277720474	1.949678221")
)

earningsVsGDPRate.main<-function(){
	pathToMe<-dirname(sys.frame(1)$ofile)
	
	source(paste(pathToMe,"/../settings/GlobalVariables.R",sep=""))
	source(paste(pathToMe,"/../utils/miscUtils.R",sep=""))
	
	library(timeSeries)
	
	coreSettings<-global.core()
	mktDataFile<-paste(coreSettings[["input"]],"prdInputs.RData",sep="")
	dataItems<-c(".earnings")
	assets<-c("us.equity","fr.cac40","ge.equity","uk.equity","sw.omx30","eu.stxe600","eu.eurostx","jp.equity","au.asx200","sg.equity","hk.equity","no.equity","ca.equity","nl.equity")
	
	assetData<-utils.getDataFromFile(assets,dataItems,mktDataFile,"%Y-%m-%d")
	dates<-row.names(assetData)
	assetData<-assetData[dates<="2010-12-31" & dates>"1960-12-30",]
	rates<-as.matrix(assetData[1:(nrow(assetData)-1),])/as.matrix(assetData[2:nrow(assetData),])-1
	for(i in 1:ncol(assetData)){
		cc<-substr(names(assetData)[i],1,2)
		newCol<-rev(as.numeric(rates[as.logical(is.finite(rates[,i])),i]))
		wbYoYRate<-strsplit(earningsVsGDPRate.wbData[[cc]],"\t")[[1]]
		wbYoYRate<-as.numeric(wbYoYRate[wbYoYRate!="NA"])/100.

		lll<-min(nrow(newCol),length(wbYoYRate))
		earnLine<-newCol[(length(newCol)-lll+1):length(newCol)]
		gdpLine<-wbYoYRate[(length(wbYoYRate)-lll+1):length(wbYoYRate)]
		dev.new()
		plot((1961:2010)[(51-lll):50], gdpLine,main=cc,col=3,xlab="Year",ylab="return",type="l",ylim=)
		lines((1961:2010)[(51-lll):50], earnLine,col=2)
		legend("topleft",legend=c("gdp yoy rate","earnings yoy rate"),lty=1,col=3:2)
	}
	
}

earningsVsGDPRate.main()
